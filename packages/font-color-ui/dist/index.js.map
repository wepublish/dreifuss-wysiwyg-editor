{"version":3,"file":"index.js","sources":["../src/FontColorToolbar.tsx","../src/RenderLeaf.tsx"],"sourcesContent":["import React, {useEffect, useRef, useState} from 'react'\nimport {ReactEditor} from 'slate-react'\nimport {HistoryEditor} from 'slate-history'\nimport {Editor, BaseEditor} from 'slate'\nimport {useEventEditorId, useStoreEditorState} from '@udecode/plate-core'\nimport {FontColor} from '@dreifuss-wysiwyg-editor/common'\nimport {upsertFontColor} from '@dreifuss-wysiwyg-editor/font-color'\n\ntype CustomElement = {type: 'link'; title: string; color?: string; children: CustomText[]}\ntype CustomText = {title: string; text: string}\ndeclare module 'slate' {\n  interface CustomTypes {\n    Editor: BaseEditor & ReactEditor & HistoryEditor\n    Element: CustomElement\n    Text: CustomText\n  }\n}\n\ninterface FontColorToolbarProps {\n  icon?: any\n}\n\nexport const FontColorToolbar = (props: FontColorToolbarProps) => {\n  const editor = useStoreEditorState(useEventEditorId('focus'))\n\n  const [color, setColor] = useState<string>('#fff')\n\n  const [isSelectingColoredNode, setSelectingColoredNode] = useState<boolean>(false)\n\n  const textInput = useRef<HTMLInputElement>(null)\n\n  useEffect(() => {\n    if (!editor?.selection) return\n\n    const nodes: Array<any> | null = Array.from(\n      Editor.nodes(editor, {\n        at: editor.selection,\n        // @ts-ignore\n        match: node => !!node.color\n      })\n    )\n\n    if (nodes?.length) {\n      setColor(nodes[0][0].color)\n      setSelectingColoredNode(true)\n    } else {\n      setSelectingColoredNode(false)\n    }\n  }, [editor?.selection])\n\n  return (\n    <div onClick={() => textInput.current?.click()}>\n      {props?.icon || <FontColor active={!!isSelectingColoredNode} />}\n      <input\n        type=\"color\"\n        ref={textInput}\n        value={color}\n        onChange={e => {\n          if (!editor) return\n\n          const color = e.target.value\n          if (color) setColor(color)\n\n          upsertFontColor(editor, color)\n        }}\n        style={{\n          width: 0,\n          visibility: 'hidden'\n        }}\n      />\n    </div>\n  )\n}\n","import React from 'react'\n\nexport const RenderFontColorLeaf = ({attributes, children, leaf}: any) => (\n  <span {...attributes} style={{color: leaf?.color}}>\n    {children}\n  </span>\n)\n"],"names":["FontColorToolbar","props","editor","useStoreEditorState","useEventEditorId","color","setColor","useState","isSelectingColoredNode","setSelectingColoredNode","textInput","useRef","useEffect","selection","nodes","Array","from","Editor","at","match","node","length","_jsxs","current","click","icon","_jsx","FontColor","e","target","value","upsertFontColor","width","visibility","RenderFontColorLeaf","attributes","children","leaf"],"mappings":";;;;;;;;;;;MAsBaA,gBAAgB,GAAIC,KAAD,IAAkC;AAChE,QAAMC,MAAM,GAAGC,6BAAmB,CAACC,0BAAgB,CAAC,OAAD,CAAjB,CAAlC;AAEA,QAAM,CAACC,KAAD,EAAQC,QAAR,IAAoBC,cAAQ,CAAS,MAAT,CAAlC;AAEA,QAAM,CAACC,sBAAD,EAAyBC,uBAAzB,IAAoDF,cAAQ,CAAU,KAAV,CAAlE;AAEA,QAAMG,SAAS,GAAGC,YAAM,CAAmB,IAAnB,CAAxB;AAEAC,EAAAA,eAAS,CAAC,MAAM;AACd,QAAI,EAACV,MAAD,aAACA,MAAD,eAACA,MAAM,CAAEW,SAAT,CAAJ,EAAwB;AAExB,UAAMC,KAAwB,GAAGC,KAAK,CAACC,IAAN,CAC/BC,YAAM,CAACH,KAAP,CAAaZ,MAAb,EAAqB;AACnBgB,MAAAA,EAAE,EAAEhB,MAAM,CAACW,SADQ;AAEnB;AACAM,MAAAA,KAAK,EAAEC,IAAI,IAAI,CAAC,CAACA,IAAI,CAACf;AAHH,KAArB,CAD+B,CAAjC;;AAQA,QAAIS,KAAJ,aAAIA,KAAJ,eAAIA,KAAK,CAAEO,MAAX,EAAmB;AACjBf,MAAAA,QAAQ,CAACQ,KAAK,CAAC,CAAD,CAAL,CAAS,CAAT,EAAYT,KAAb,CAAR;AACAI,MAAAA,uBAAuB,CAAC,IAAD,CAAvB;AACD,KAHD,MAGO;AACLA,MAAAA,uBAAuB,CAAC,KAAD,CAAvB;AACD;AACF,GAjBQ,EAiBN,CAACP,MAAD,aAACA,MAAD,uBAACA,MAAM,CAAEW,SAAT,CAjBM,CAAT;AAmBA,sBACES;AAAK,IAAA,OAAO,EAAE;AAAA;;AAAA,mCAAMZ,SAAS,CAACa,OAAhB,uDAAM,mBAAmBC,KAAnB,EAAN;AAAA,KAAd;AAAA,eACG,CAAAvB,KAAK,SAAL,IAAAA,KAAK,WAAL,YAAAA,KAAK,CAAEwB,IAAP,kBAAeC,eAACC,gBAAD;AAAW,MAAA,MAAM,EAAE,CAAC,CAACnB;AAArB,MADlB,eAEEkB;AACE,MAAA,IAAI,EAAC,OADP;AAEE,MAAA,GAAG,EAAEhB,SAFP;AAGE,MAAA,KAAK,EAAEL,KAHT;AAIE,MAAA,QAAQ,EAAEuB,CAAC,IAAI;AACb,YAAI,CAAC1B,MAAL,EAAa;AAEb,cAAMG,KAAK,GAAGuB,CAAC,CAACC,MAAF,CAASC,KAAvB;AACA,YAAIzB,KAAJ,EAAWC,QAAQ,CAACD,KAAD,CAAR;AAEX0B,QAAAA,yBAAe,CAAC7B,MAAD,EAASG,KAAT,CAAf;AACD,OAXH;AAYE,MAAA,KAAK,EAAE;AACL2B,QAAAA,KAAK,EAAE,CADF;AAELC,QAAAA,UAAU,EAAE;AAFP;AAZT,MAFF;AAAA,IADF;AAsBD;;MCtEYC,mBAAmB,GAAG,CAAC;AAACC,EAAAA,UAAD;AAAaC,EAAAA,QAAb;AAAuBC,EAAAA;AAAvB,CAAD,kBACjCX,4BAAUS,UAAV;AAAsB,EAAA,KAAK,EAAE;AAAC9B,IAAAA,KAAK,EAAEgC,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEhC;AAAd,GAA7B;AAAA,YACG+B;AADH;;;;;"}