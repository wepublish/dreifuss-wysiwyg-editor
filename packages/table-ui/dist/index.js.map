{"version":3,"file":"index.js","sources":["../src/TableElement/TableElement.styles.ts","../src/TableElement/TableElement.tsx","../src/ToolbarTable/ToolbarTable.tsx","../src/ToolbarBorderColor.tsx","../src/ToolbarBackgroundColor.tsx","../src/TableDataElement/TableDataElement.tsx"],"sourcesContent":["import {createStyles, StyledElementProps} from '@udecode/plate-styled-components'\nimport tw from 'twin.macro'\n\nexport const getTableElementStyles = (props: StyledElementProps) =>\n  createStyles(\n    {prefixClassNames: 'TableElement', ...props},\n    {\n      root: tw`w-full my-2.5 mx-0 border-collapse`\n    }\n  )\n","import * as React from 'react'\nimport {StyledElementProps} from '@udecode/plate-styled-components'\nimport {getTableElementStyles} from './TableElement.styles'\n\nexport const TableElement = (props: StyledElementProps) => {\n  const {attributes, children, nodeProps} = props\n\n  const {root} = getTableElementStyles(props)\n\n  return (\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    // TODO: fix css attr\n    <table {...attributes} css={root.css} className={root.className} {...nodeProps}>\n      <tbody>{children}</tbody>\n    </table>\n  )\n}\n","import * as React from 'react'\nimport {getPreventDefaultHandler, someNode} from '@udecode/plate-common'\nimport {getPlatePluginType, useEventEditorId, useStoreEditorState} from '@udecode/plate-core'\nimport {ELEMENT_TABLE} from '@dreifuss-wysiwyg-editor/table'\nimport {ToolbarButton} from '@udecode/plate-toolbar'\nimport {ToolbarTableProps} from './ToolbarTable.types'\n\nexport const ToolbarTable = ({transform, header, ...props}: ToolbarTableProps) => {\n  const editor = useStoreEditorState(useEventEditorId('focus'))\n  const type = getPlatePluginType(editor, ELEMENT_TABLE)\n\n  return (\n    <ToolbarButton\n      active={\n        !!editor?.selection &&\n        someNode(editor, {\n          match: {type}\n        })\n      }\n      onMouseDown={\n        !!type && editor ? getPreventDefaultHandler(transform, editor, {header}) : undefined\n      }\n      {...props}\n    />\n  )\n}\n","import React, {useEffect, useRef, useState} from 'react'\nimport {Editor, Element} from 'slate'\nimport {getPlatePluginType, useEventEditorId, useStoreEditorState} from '@udecode/plate-core'\nimport {BorderColorIcon} from '@dreifuss-wysiwyg-editor/common'\nimport {ELEMENT_TD, upsertBorderColor} from '@dreifuss-wysiwyg-editor/table'\n\ninterface TableBorderColorToolbarProps {\n  icon?: any\n}\n\nconst DEFAULT_TD_BORDER_COLOR = '#000'\n\nexport const TableBorderColorToolbar = (props: TableBorderColorToolbarProps) => {\n  const editor = useStoreEditorState(useEventEditorId('focus'))\n\n  const [borderColor, setBorderColor] = useState<string>(DEFAULT_TD_BORDER_COLOR)\n\n  const textInput = useRef<HTMLInputElement>(null)\n\n  useEffect(() => {\n    if (!editor?.selection) return\n    const nodes: Array<any> | null = Array.from(\n      Editor.nodes(editor, {\n        at: editor.selection,\n        match: node =>\n          Element.isElement(node) && node.type === getPlatePluginType(editor, ELEMENT_TD)\n      })\n    )\n    if (nodes?.length) {\n      setBorderColor(nodes[0][0].borderColor || DEFAULT_TD_BORDER_COLOR)\n    }\n  }, [editor?.selection])\n\n  return (\n    <div onClick={() => textInput.current?.click()}>\n      {props.icon ?? <BorderColorIcon />}\n      <input\n        type=\"color\"\n        ref={textInput}\n        value={borderColor}\n        onChange={e => {\n          if (!editor) return\n\n          const color = e.target.value\n          if (color) setBorderColor(color)\n\n          upsertBorderColor(editor, color)\n        }}\n        style={{\n          width: 0,\n          visibility: 'hidden'\n        }}\n      />\n    </div>\n  )\n}\n","import React, {useEffect, useRef, useState} from 'react'\nimport {ReactEditor} from 'slate-react'\nimport {HistoryEditor} from 'slate-history'\nimport {Editor, Element, BaseEditor} from 'slate'\nimport {getPlatePluginType, useEventEditorId, useStoreEditorState} from '@udecode/plate-core'\nimport {BackgroundColorIcon} from '@dreifuss-wysiwyg-editor/common'\nimport {ELEMENT_TD, upsertBgColor} from '@dreifuss-wysiwyg-editor/table'\n\ntype CustomElement = {\n  type: 'td'\n  title: string\n  borderColor?: string\n  backgroundColor?: string\n  children: CustomText[]\n}\ntype CustomText = {title: string; text: string}\ndeclare module 'slate' {\n  interface CustomTypes {\n    Editor: BaseEditor & ReactEditor & HistoryEditor\n    Element: CustomElement\n    Text: CustomText\n  }\n}\n\ninterface ToolbarBackgroundColorProps {\n  icon?: any\n}\n\nconst DEFAULT_TD_BG_COLOR = '#fff'\n\nexport const TableBgColorToolbar = (props: ToolbarBackgroundColorProps) => {\n  const editor = useStoreEditorState(useEventEditorId('focus'))\n\n  const [bgColor, setBgColor] = useState<string>(DEFAULT_TD_BG_COLOR)\n\n  const textInput = useRef<HTMLInputElement>(null)\n\n  useEffect(() => {\n    if (!editor?.selection) return\n    const nodes: Array<any> | null = Array.from(\n      Editor.nodes(editor, {\n        at: editor.selection,\n        match: node =>\n          Element.isElement(node) && node.type === getPlatePluginType(editor, ELEMENT_TD)\n      })\n    )\n    if (nodes?.length) {\n      setBgColor(nodes[0][0].backgroundColor || DEFAULT_TD_BG_COLOR)\n    }\n  }, [editor?.selection])\n\n  return (\n    <div onClick={() => textInput.current?.click()}>\n      {props.icon ?? <BackgroundColorIcon />}\n      <input\n        type=\"color\"\n        ref={textInput}\n        value={bgColor}\n        onChange={e => {\n          if (!editor) return\n\n          const color = e.target.value\n          if (color) setBgColor(color)\n\n          upsertBgColor(editor, color)\n        }}\n        style={{\n          width: 0,\n          visibility: 'hidden'\n        }}\n      />\n    </div>\n  )\n}\n","import * as React from 'react'\n\nexport const TableDataElement = (props: any) => {\n  const {backgroundColor = 'rgb(255, 255, 255)', borderColor = 'rgb(0, 0, 0, 0.5)'} = props?.element\n\n  return (\n    <td\n      {...props.attributes}\n      className={props.className}\n      style={{\n        border: '1px solid rgb(193, 199, 208)',\n        padding: '8px',\n        minWidth: '48px',\n        selectors: {\n          '> *': {\n            margin: 0\n          }\n        },\n        borderColor: borderColor,\n        backgroundColor: backgroundColor\n      }}>\n      {props.children}\n    </td>\n  )\n}\n"],"names":["getTableElementStyles","props","createStyles","prefixClassNames","root","TableElement","attributes","children","nodeProps","className","css","_jsx","ToolbarTable","transform","header","editor","useStoreEditorState","useEventEditorId","type","getPlatePluginType","ELEMENT_TABLE","ToolbarButton","selection","someNode","match","getPreventDefaultHandler","undefined","DEFAULT_TD_BORDER_COLOR","TableBorderColorToolbar","borderColor","setBorderColor","useState","textInput","useRef","useEffect","nodes","Array","from","Editor","at","node","Element","isElement","ELEMENT_TD","length","_jsxs","current","click","icon","BorderColorIcon","e","color","target","value","upsertBorderColor","width","visibility","DEFAULT_TD_BG_COLOR","TableBgColorToolbar","bgColor","setBgColor","backgroundColor","BackgroundColorIcon","upsertBgColor","TableDataElement","element","border","padding","minWidth","selectors","margin"],"mappings":"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"}